#######################################################
#                                                     #
#              PACKAGES / HOME ASSISTANT              #
#                                                     #
#######################################################

homeassistant:
  customize_glob:
    "*version*":
      icon: mdi:package-up
  customize:
    script.restart_hass:
      icon: mdi:restart
      friendly_name: Restart Home Assistant
    script.clear_caches:
      icon: mdi:delete
      friendly_name: Clear DB/Log/TTS
    automation.hass_notify_new_release:
      icon: mdi:alert-package-up
    automation.hass_notify_system_start:
      icon: mdi:power
    automation.hass_notify_system_shutdown:
      icon: mdi:power
    binary_sensor.updater:
      icon: mdi:alert-package-up

#######################################################
#                                                     #
#                       SENSOR                        #
#                                                     #
#######################################################

sensor:
  ## HA version
  - platform: version
    name: Installed Version

  ## HA available version
  - platform: version
    name: Latest Available Version
    beta: false
    source: hassio

#######################################################
#                                                     #
#                     AUTOMATIONS                     #
#                                                     #
#######################################################

automation:
  - alias: Hass Notify - New Release
    hide_entity: True
    trigger:
      - platform: state
        entity_id: updater.updater
    action:
      service: notify.matt
      data_template:
        title: '{{ "\u2699\uFE0F"}} New Home Assistant Release'
        message: "Home Assistant  {{ states.updater.updater.state }}  is now available."

  - alias: Hass Notify - System Start
    hide_entity: True
    trigger:
      - platform: homeassistant
        event: start
    action:
      service: notify.matt
      data_template:
        title: '{{ "\u2699\uFE0F"}} Home Assistant started'
        message: "Powering up..."

  - alias: Hass Notify - System Shutdown
    hide_entity: True
    trigger:
      - platform: homeassistant
        event: shutdown
    action:
      service: notify.matt
      data_template:
        title: '{{ "\u2699\uFE0F"}} Home Assistant shut down'
        message: "Until next time..."

#######################################################
#                                                     #
#                       SCRIPTS                       #
#                                                     #
#######################################################

script:
  restart_hass:
    sequence:
      - service: homeassistant.restart
  clear_caches:
    sequence:
      - service: tts.clear_cache
      - service: recorder.purge
      - service: system_log.clear
